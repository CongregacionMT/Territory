<div class="container">
  <app-breadcrumb [routerBreadcrum]="routerBreadcrum()"></app-breadcrumb>

  @if (filterDataListFull() && filterDataListFull().length > 0) {
    <div class="d-flex justify-content-evenly my-5 filter-class">
      <div class="d-flex align-items-center m-4">
        <label for="select-filter-register" class="text-center w-100 fs-4">Filtrar por: </label>
        <select id="select-filter-register" class="form-select" aria-label="Default select example"
          [(ngModel)]="selectedValueFilter"
          (ngModelChange)="sortByDate($event)">
          <option selected value=1>Últimos 6 meses</option>
          <option value="2">Último año</option>
          <option value="2023">2023</option>
          <option value="2022">2022</option>
        </select>
      </div>
      <button class="btn btn-danger btn-lg me-2" (click)="downloadPDF()">
        Descargar registro PDF
      </button>
    </div>
    <!-- Tabla de territorios completa -->
    <div>
      <table class="table table-dark table-full">
        <thead>
          <tr>
            @for (item of territoriesNumber(); track item) {
              <th scope="col" class="fs-5 text-center">Territorio {{item.territorio}}</th>
            }
          </tr>
        </thead>
        <tbody class="table-group-divider">
          <tr class="m-0 p-0">
            @for (dataList of filterDataListFull(); track dataList) {
              <td>
                @for (list of dataList; track list) {
                  <table class="table table-dark m-0">
                    @if (list.end) {
                      <tr>
                        <td class="d-flex justify-content-center fs-4" style="border-bottom: 0px transparent;">{{list.driver}}</td>
                      </tr>
                    }
                    @if (list.end) {
                      <tr>
                        <table class="table table-dark table-striped table-hover table-bordered row-border m-0">
                          <tr class="d-flex justify-content-around" style="border: 0px transparent;">
                            <th scope="col" class="px-2">Entregó</th>
                            <th scope="col" class="px-2">Devolvió</th>
                          </tr>
                          <tr class="d-flex justify-content-around py-0" style="border: 0px transparent;">
                            <td class="pe-3">{{list.start | date:"dd-MM-yyyy"}}</td>
                            |
                            <td class="ps-3">{{list.end | date:"dd-MM-yyyy"}}</td>
                          </tr>
                        </table>
                      </tr>
                    }
                    @if (list.end) {
                      <hr class="m-1">
                    }
                  </table>
                }
              </td>
            }
          </tr>
        </tbody>
      </table>
    </div>
  } @else {
    <div class="alert alert-info mt-5 text-center" role="alert">
      <h4 class="alert-heading">Sin datos disponibles</h4>
      <p>No hay registros de territorios para mostrar en este momento.</p>
    </div>
  }
</div>
